{# templates/pdf/equipements.html.twig - VERSION SIMPLE AVEC CSS EXTERNE #}
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Équipements du client - {{ client.nom ?? 'Client' }}</title>
    <link rel="stylesheet" href="{{ asset('css/pdf-equipements.css') }}">
</head>
<body{% if agence is defined and agence %} style='background-image: url("https://www.backend-kizeo.somafi-group.fr/public/img/background/{{ agence|lower }}.jpg")'{% endif %}>
    <div class="content">
        {% if equipements is defined and equipements|length > 0 %}
            {% for equipement in equipements %}
                <table class="equipment-main-table">
                    <tr>
                        <td class="equipment-photo-cell">
                            {% if equipement.photosPrincipale is defined and equipement.photosPrincipale|length > 0 %}
                                <img src="data:image/png;base64, {{ equipement.photosPrincipale }}" 
                                     alt="Photo {{ equipement.numero }}" class="equipment-photo">
                            {% else %}
                                <img src="data:image/png;base64, {{ equipement.photosSecondaire }}" 
                                     alt="Photo {{ equipement.numero }}" class="equipment-photo">
                            {% endif %}
                        </td>
                        <td class="equipment-info-cell">
                            <table class="equipment-info-table">
                                <tr>
                                    <td class="info-label">Équipement</td>
                                    <td class="info-value">
                                        <strong>{{ equipement.numero ?? 'N/A' }} - {{ equipement.type.libelle ?? 'Non renseigné' }}</strong>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="info-label">Numéro</td>
                                    <td class="info-value">{{ equipement.numero ?? 'N/A' }}</td>
                                </tr>
                                <tr>
                                    <td class="info-label">Type</td>
                                    <td class="info-value">{{ equipement.type.libelle ?? 'Non renseigné' }}</td>
                                </tr>
                                <tr>
                                    <td class="info-label">Marque</td>
                                    <td class="info-value">{{ equipement.marque ?? 'Non renseigné' }}</td>
                                </tr>
                                <tr>
                                    <td class="info-label">Modèle</td>
                                    <td class="info-value">{{ equipement.modele ?? 'Non renseigné' }}</td>
                                </tr>
                                <tr>
                                    <td class="info-label">État</td>
                                    <td class="info-value equipment-status {% if equipement.statut is defined and equipement.statut == 'urgent' %}status-urgent-text{% elseif equipement.statut is defined and equipement.statut == 'attention' %}status-attention-text{% else %}status-bon-text{% endif %}">
                                        {{ equipement.statutLibelle ?? 'Non défini' }}
                                    </td>
                                </tr>
                                {# <tr>
                                    <td class="info-label">Mise en service</td>
                                    <td class="info-value">
                                        {% if equipement.dateMiseEnService %}
                                            {{ equipement.dateMiseEnService|date('d/m/Y') }}
                                        {% endif %}
                                    </td>
                                </tr> #}
                                <tr>
                                    <td class="info-label">Repère site client</td>
                                    <td class="info-value">{{ equipement.repereSite ?? '' }}</td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </table>
                
                {% if equipement.anomalies is defined and equipement.anomalies|length > 0 %}
                <div class="anomalies-section">
                    <div class="anomalies-title">Anomalies</div>
                    {% for anomalie in equipement.anomalies %}
                        <div>{{ anomalie.description ?? anomalie }}</div>
                    {% endfor %}
                </div>
                {% endif %}
                
                {% if equipement.photosSecondaires is defined and equipement.photosSecondaires|length > 0 %}
                <div class="additional-photos">
                    <div class="photos-grid">
                        {% for photo in equipement.photosSecondaires %}
                        <div class="photo-container">
                            <img src="{{ asset('uploads/equipements/' ~ photo.filename) }}" 
                                 alt="Photo {{ photo.description ?? '' }}" class="photo-thumbnail">
                            <div class="photo-caption">{{ photo.description ?? '' }}</div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}
                
                {% if not loop.last %}
                    <div class="page-break"></div>
                {% endif %}
            {% endfor %}
        {% else %}
            <div style="text-align: center; padding: 50px;">
                <h2>Aucun équipement trouvé</h2>
            </div>
        {% endif %}
    </div>
</body>
</html>